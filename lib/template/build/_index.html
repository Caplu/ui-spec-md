<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title><%= title || 'UI specification' %></title>
<link rel="stylesheet" href="./_template/_template.css">
<script src="./_template/_template.js"></script>
</head>
<body>

<div class="UISP">

	<header class="UISP-Header">
		<div class="UISP-Header__title">
			<%= title || 'UI specification' %>
		</div>
	</header>

	<div class="UISP-Body">
		<div class="UISP-Index">
			<div class="UISP-Index__list">
				<div class="UISP-Index__listHeader">
					<div class="UISP-Index__search">
						<input id="UISP-Index__searchInput">
					</div>
				</div>

				<div class="UISP-Index__listBody">

					<% pageDataList.forEach( function ( item ) { %>
						<div class="UISP-Index__listItem">
							<a href="<%= item.fromRoot + item.filename %>">
								<div class="UISP-Index__itemImage">
									<div class="UISP-Index__itemImageInner">
										<img src="<%= item.fromRoot + item.screen %>" alt="">
									</div>
								</div>
								<div class="UISP-Index__itemTitle">
									<%= item.title %>
								</div>
							</a>
						</div>
					<% } ); %>

				</div>
			</div>
			<div class="UISP-Index__readme">
				<div class="UISP-Md">
					<%= readmeSrc %>
				</div>
			</div>
		</div>
	</div>

</div>

<script>
;( function () {

	var $input = document.getElementById( 'UISP-Index__searchInput' );
	var $items = document.querySelectorAll( '.UISP-Index__listItem' );
	var collection = [];
	var render = function () {

		collection.forEach( function ( item, i ) {

			$items[ i ].setAttribute( 'aria-hidden', !item.isVisible );

		} );

	}

	Array.prototype.forEach.call( $items, function ( $item, i ) {

		var text = $item.querySelector( '.UISP-Index__itemTitle' ).textContent
		           .replace( /(^\s+|\s+$)/g, '' );
		collection.push( {
			text: text,
			isVisible: true
		} );

	} );

	$input.addEventListener( 'keyup', function ( e ) {

		if ( /^\s+$/.test( $input.value ) ) {

			collection.forEach( function ( item, i ) {

				// set showAll
				item.isVisible = true;

			} );

			render();
			return;

		}

		var pattern = new RegExp( $input.value );

		collection.forEach( function ( item, i ) {

			 item.isVisible = pattern.test( item.text );

		} );

		render();
		return;

	} );

} )();
</script>

</body>
</html>
